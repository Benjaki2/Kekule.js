!function(e){"use strict";var n=Kekule.EmscriptenUtils,i={usingModulaize:!0,moduleName:"IndigoModule",moduleInitEventName:"Indigo.Initialized",moduleInitCallbackName:"__$indigoInitialized$__",indigoAdaptFuncName:"CreateIndigo"};Kekule.Indigo={_autoEnabled:!0,_module:null,_indigo:null,SCRIPT_FILE:"indigo.js",HELPER_SCRIPT_FILE:"indigoAdapter.js",_enableFuncs:[],isScriptLoaded:function(){return n.isSupported(i.moduleName)&&void 0!==e[i.indigoAdaptFuncName]},getModule:function(){return t._module||(t._module=n.getRootModule(i.moduleName)),t._module},setModule:function(e){t._module=e,n.setRootModule(i.moduleName,e)},getIndigo:function(){if(!t._indigo){var n=t.getModule();n&&(t._indigo=e[i.indigoAdaptFuncName](n))}return t._indigo},getClassCtor:function(e){return n.getClassCtor(e,t.getModule())},isAvailable:function(){return t.getModule()&&t.getIndigo()},enable:function(e){t.isScriptLoaded()?(t._enableAllFunctions(),e&&e()):t.loadIndigoScript(Kekule.$jsRoot.document,function(n){n||t._enableAllFunctions(),e&&e(n)})},_enableAllFunctions:function(){if(n.isModuleReady(i.moduleName))for(var e=t._enableFuncs,o=0,l=e.length;o<l;++o){var u=e[o];u&&u()}}},Kekule.Indigo.getIndigoPath=function(){var e=Kekule.environment.getEnvVar("indigo.path");e||(e=Kekule.scriptSrcInfo.useMinFile?"extra/":"_extras/Indigo/",e=Kekule.scriptSrcInfo.path+e);return e},Kekule.Indigo.getIndigoScriptUrl=function(){var e=Kekule.environment.getEnvVar("indigo.path");e||(e=t.getIndigoPath()+t.SCRIPT_FILE,Kekule.scriptSrcInfo.useMinFile||(e+=".dev"));return e},Kekule.Indigo.getIndigoHelperScriptUrl=function(){return t.getIndigoPath()+t.HELPER_SCRIPT_FILE},Kekule.Indigo.loadIndigoScript=function(e,o){e||(e=Kekule.$jsRoot.document);var l=function(e){t._scriptLoadedBySelf=!e,e||Kekule.Indigo.getIndigo(),o&&o(e)};if(t._scriptLoadedBySelf||t.isScriptLoaded())l();else{var u=t.getIndigoScriptUrl();n.loadScript(u,function(n){n?l(n):Kekule.ScriptFileUtils.appendScriptFiles(e,[t.getIndigoHelperScriptUrl()],l)},e,i)}};var t=Kekule.Indigo;Kekule.Indigo.AdaptUtils={},Kekule._registerAfterLoadSysProc(function(){t._autoEnabled&&t.isScriptLoaded()&&n.ensureModuleReady(Kekule.$jsRoot.document,i,t._enableAllFunctions)})}(this),function(){"use strict";Kekule.EmscriptenUtils;var e=Kekule.Indigo;Kekule.IO.IndigoReader=Class.create(Kekule.IO.ChemDataReader,{CLASS_NAME:"Kekule.IO.InChIWriter",doReadData:function(n,i,t){var o=e.getIndigo(),l=o.loadMoleculeFromString(n);if(l>=0){t===Kekule.IO.DataFormat.SMILES&&(o.setOption("smart-layout","true"),o.layout(l));var u=o.molfile(l);return o.free(l),Kekule.IO.loadFormatData(u,Kekule.IO.DataFormat.MOL)}return null}}),Kekule.IO.registerAllIndigoFormats=function(){e.isAvailable()&&Kekule.IO.ChemDataReaderManager.register("Indigo-smiles",Kekule.IO.IndigoReader,Kekule.IO.DataFormat.SMILES)},Kekule.IO.enableIndigoFormats=function(){e.isAvailable()?Kekule.IO.registerAllIndigoFormats():e.loadIndigoScript(document,function(){Kekule.IO.registerAllIndigoFormats()})},e._enableFuncs.push(Kekule.IO.registerAllIndigoFormats)}();